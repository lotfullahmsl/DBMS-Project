<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Checkout | SoleNest</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap");

      body {
        font-family: "Poppins", sans-serif;
      }

      .input-focus:focus {
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
      }

      .checkout-item:hover .remove-item {
        opacity: 1;
      }

      .payment-method:hover {
        border-color: #3b82f6;
      }

      .payment-method.selected {
        border-color: #3b82f6;
        background-color: #eff6ff;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Header -->
      <div class="flex justify-between items-center mb-8">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">SoleNest</h1>
        </div>
        <div class="flex items-center space-x-4">
          <div class="flex items-center">
            <div
              class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-600 text-white font-medium"
            >
              1
            </div>
            <div class="ml-2 text-sm font-medium text-gray-900">Cart</div>
          </div>
          <div class="flex items-center">
            <div class="w-16 h-0.5 bg-gray-300"></div>
          </div>
          <div class="flex items-center">
            <div
              class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-600 text-white font-medium"
            >
              2
            </div>
            <div class="ml-2 text-sm font-medium text-gray-900">Details</div>
          </div>
          <div class="flex items-center">
            <div class="w-16 h-0.5 bg-gray-300"></div>
          </div>
          <div class="flex items-center">
            <div
              class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-medium"
            >
              3
            </div>
            <div class="ml-2 text-sm font-medium text-gray-500">Payment</div>
          </div>
        </div>
      </div>

      <div class="flex flex-col lg:flex-row gap-8">
        <!-- Left Column - Shipping and Payment -->
        <div class="lg:w-2/3">
          <!-- Shipping Information -->
          <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
            <div class="flex justify-between items-center mb-6">
              <h2 class="text-lg font-medium text-gray-900">
                Shipping Information
              </h2>
              <button
                id="edit-shipping"
                class="text-sm font-medium text-blue-600 hover:text-blue-500"
              >
                Edit
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
              <div>
                <label
                  for="first-name"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >First name</label
                >
                <input
                  type="text"
                  id="first-name"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                  value="John"
                  readonly
                />
              </div>
              <div>
                <label
                  for="last-name"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Last name</label
                >
                <input
                  type="text"
                  id="last-name"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                  value="Doe"
                  readonly
                />
              </div>
            </div>

            <div class="mb-4">
              <label
                for="address"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Address</label
              >
              <input
                type="text"
                id="address"
                class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                value="123 Main St"
                readonly
              />
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <div>
                <label
                  for="city"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >City</label
                >
                <input
                  type="text"
                  id="city"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                  value="Islamabad"
                  readonly
                />
              </div>
              <div>
                <label
                  for="state"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >State</label
                >
                <select
                  id="state"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                  disabled
                >
                  <option>Islamabad</option>
                  <option>Lahor</option>
                  <option>Karachi</option>
                </select>
              </div>
              <div>
                <label
                  for="zip"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >ZIP Code</label
                >
                <input
                  type="text"
                  id="zip"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                  value="10001"
                  readonly
                />
              </div>
            </div>

            <div class="mb-4">
              <label
                for="phone"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Phone</label
              >
              <input
                type="tel"
                id="phone"
                class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                value="+1 (555) 123-4567"
                readonly
              />
            </div>

            <div class="flex items-center">
              <input
                id="save-info"
                type="checkbox"
                class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
              />
              <label for="save-info" class="ml-2 block text-sm text-gray-700"
                >Save this information for next time</label
              >
            </div>
          </div>

          <!-- Payment Method -->
          <div class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-lg font-medium text-gray-900 mb-6">
              Payment Method
            </h2>

            <div class="mb-4">
              <label
                for="payment-name"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Name</label
              >
              <input
                type="text"
                id="payment-name"
                class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                placeholder="John Doe"
              />
            </div>

            <div class="space-y-4 mb-6">
              <div
                class="payment-method border border-gray-200 rounded-lg p-4 cursor-pointer selected"
              >
                <div class="flex items-center">
                  <div
                    class="flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 mr-3"
                  >
                    <div class="w-3 h-3 rounded-full bg-blue-600"></div>
                  </div>
                  <div class="flex-1">
                    <div class="flex items-center justify-between">
                      <span class="font-medium">Credit Card</span>
                      <div class="flex space-x-2">
                        <img
                          src="https://cdn3.iconfinder.com/data/icons/payment-method-1/64/_Visa-512.png"
                          class="h-6"
                          alt="Visa"
                        />
                        <img
                          src="https://upload.wikimedia.org/wikipedia/commons/0/04/Mastercard-logo.png"
                          class="h-6"
                          alt="Mastercard"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mt-4 pl-9">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label
                        for="card-number"
                        class="block text-sm font-medium text-gray-700 mb-1"
                        >Card number</label
                      >
                      <input
                        type="text"
                        id="card-number"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                        placeholder="1234 5678 9012 3456"
                      />
                    </div>
                    <div>
                      <label
                        for="card-name"
                        class="block text-sm font-medium text-gray-700 mb-1"
                        >Name on card</label
                      >
                      <input
                        type="text"
                        id="card-name"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                        placeholder="John Doe"
                      />
                    </div>
                  </div>

                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                    <div>
                      <label
                        for="expiry-date"
                        class="block text-sm font-medium text-gray-700 mb-1"
                        >Expiry date</label
                      >
                      <input
                        type="text"
                        id="expiry-date"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                        placeholder="MM/YY"
                      />
                    </div>
                    <div>
                      <label
                        for="cvv"
                        class="block text-sm font-medium text-gray-700 mb-1"
                        >CVV</label
                      >
                      <input
                        type="text"
                        id="cvv"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                        placeholder="123"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="payment-method border border-gray-200 rounded-lg p-4 cursor-pointer"
              >
                <div class="flex items-center">
                  <div
                    class="flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 mr-3"
                  >
                    <div class="w-3 h-3 rounded-full bg-transparent"></div>
                  </div>
                  <div class="flex-1">
                    <div class="flex items-center justify-between">
                      <span class="font-medium">PayPal</span>
                      <img
                        src="https://cdn4.iconfinder.com/data/icons/logos-and-brands/512/250_Paypal_logo-256.png"
                        src=""
                        class="h-6"
                        alt="PayPal"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="payment-method border border-gray-200 rounded-lg p-4 cursor-pointer"
              >
                <div class="flex items-center">
                  <div
                    class="flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 mr-3"
                  >
                    <div class="w-3 h-3 rounded-full bg-transparent"></div>
                  </div>
                  <div class="flex-1">
                    <div class="flex items-center justify-between">
                      <span class="font-medium">Apple Pay</span>
                      <img
                        src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/apple/apple-original.svg"
                        class="h-6"
                        alt="Apple Pay"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-6">
              <h3 class="text-sm font-medium text-gray-700 mb-2">
                Billing address
              </h3>
              <div class="flex items-center">
                <input
                  id="same-as-shipping"
                  type="radio"
                  name="billing-address"
                  class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"
                  checked
                />
                <label
                  for="same-as-shipping"
                  class="ml-2 block text-sm text-gray-700"
                  >Same as shipping address</label
                >
              </div>
              <div class="flex items-center mt-2">
                <input
                  id="different-billing"
                  type="radio"
                  name="billing-address"
                  class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"
                />
                <label
                  for="different-billing"
                  class="ml-2 block text-sm text-gray-700"
                  >Use a different billing address</label
                >
              </div>
              <div id="billing-fields" class="hidden mt-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                  <div>
                    <label
                      for="billing-first-name"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >First name</label
                    >
                    <input
                      type="text"
                      id="billing-first-name"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                      placeholder="Jane"
                    />
                  </div>
                  <div>
                    <label
                      for="billing-last-name"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Last name</label
                    >
                    <input
                      type="text"
                      id="billing-last-name"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                      placeholder="Doe"
                    />
                  </div>
                </div>
                <div class="mb-4">
                  <label
                    for="billing-address"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Address</label
                  >
                  <input
                    type="text"
                    id="billing-address"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                    placeholder="456 Oak St"
                  />
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                  <div>
                    <label
                      for="billing-city"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >City</label
                    >
                    <input
                      type="text"
                      id="billing-city"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                      placeholder="Los Angeles"
                    />
                  </div>
                  <div>
                    <label
                      for="billing-state"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >State</label
                    >
                    <select
                      id="billing-state"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                    >
                      <option>California</option>
                      <option>New York</option>
                      <option>Texas</option>
                    </select>
                  </div>
                  <div>
                    <label
                      for="billing-zip"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >ZIP Code</label
                    >
                    <input
                      type="text"
                      id="billing-zip"
                      class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                      placeholder="90001"
                    />
                  </div>
                </div>
                <div class="mb-4">
                  <label
                    for="billing-phone"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Phone</label
                  >
                  <input
                    type="tel"
                    id="billing-phone"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md input-focus focus:outline-none"
                    placeholder="+1 (555) 987-6543"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column - Order Summary -->
        <div class="lg:w-1/3">
          <div class="bg-white rounded-lg shadow-sm p-6 sticky top-8">
            <h2 class="text-lg font-medium text-gray-900 mb-6">
              Order Summary
            </h2>

            <div class="space-y-4 mb-6" id="order-items">
              <!-- Items will be populated dynamically -->
            </div>

            <div class="space-y-3 mb-6">
              <div class="flex justify-between">
                <span class="text-sm text-gray-600">Subtotal</span>
                <span class="text-sm font-medium text-gray-900" id="subtotal"
                  >$0.00</span
                >
              </div>
              <div class="flex justify-between">
                <span class="text-sm text-gray-600">Shipping</span>
                <span class="text-sm font-medium text-gray-900" id="shipping"
                  >$0.00</span
                >
              </div>
              <div class="flex justify-between">
                <span class="text-sm text-gray-600">Tax</span>
                <span class="text-sm font-medium text-gray-900" id="tax"
                  >$0.00</span
                >
              </div>
            </div>

            <div
              class="flex justify-between border-t border-gray-200 pt-4 mb-6"
            >
              <span class="text-base font-medium text-gray-900">Total</span>
              <span class="text-base font-bold text-gray-900" id="total"
                >$0.00</span
              >
            </div>

            <button
              id="complete-order"
              class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-md font-medium transition duration-150 ease-in-out"
            >
              Complete Order
            </button>

            <div class="mt-4 text-center text-sm text-gray-500">
              or
              <a
                href="cart.html"
                class="font-medium text-blue-600 hover:text-blue-500 ml-1"
                >Continue Shopping</a
              >
            </div>

            <div class="mt-6 border-t border-gray-200 pt-6">
              <h3 class="text-sm font-medium text-gray-900 mb-3">We accept</h3>
              <div class="flex space-x-4">
                <img
                  src="https://cdn0.iconfinder.com/data/icons/font-awesome-brands-vol-1/576/cc-visa-512.png"
                  class="h-8"
                  alt="Visa"
                />
                <img
                  src="https://cdn3.iconfinder.com/data/icons/remixicon-logos/24/mastercard-fill-512.png"
                  class="h-8"
                  alt="Mastercard"
                />
                <img
                  src="https://cdn1.iconfinder.com/data/icons/ionicons-fill-vol-2/512/logo-paypal-512.png"
                  class="h-8"
                  alt="PayPal"
                />
                <img
                  src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/apple/apple-original.svg"
                  class="h-8"
                  alt="Apple Pay"
                />
              </div>
            </div>

            <div class="mt-6 text-xs text-gray-500">
              <p>
                By completing your purchase you agree to our
                <a href="#" class="text-blue-600 hover:text-blue-500"
                  >Terms of Service</a
                >
                and
                <a href="#" class="text-blue-600 hover:text-blue-500"
                  >Privacy Policy</a
                >.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Load cart data from localStorage
      document.addEventListener("DOMContentLoaded", () => {
        const orderData = JSON.parse(localStorage.getItem("checkoutData"));
        const orderItemsContainer = document.getElementById("order-items");
        const subtotalElement = document.getElementById("subtotal");
        const shippingElement = document.getElementById("shipping");
        const taxElement = document.getElementById("tax");
        const totalElement = document.getElementById("total");

        if (orderData && orderData.items.length > 0) {
          orderItemsContainer.innerHTML = "";
          orderData.items.forEach((item, index) => {
            const itemElement = document.createElement("div");
            itemElement.className =
              "checkout-item flex justify-between items-start pb-4 border-b border-gray-200";
            itemElement.innerHTML = `
                        <div class="flex">
                            <div class="h-20 w-20 flex-shrink-0 overflow-hidden rounded-md border border-gray-200">
                                <img src="${
                                  item.imageUrl
                                }" class="h-full w-full object-cover object-center" alt="${
              item.name
            }">
                            </div>
                            <div class="ml-4">
                                <h3 class="text-sm font-medium text-gray-900">${
                                  item.name
                                }</h3>
                                <p class="mt-1 text-sm text-gray-500">${
                                  item.style
                                }</p>
                                <p class="mt-1 text-sm text-gray-500">Size: ${
                                  item.size
                                }</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-gray-900">$${item.price.toFixed(
                              2
                            )}</p>
                            <p class="mt-1 text-xs text-gray-500">Qty: ${
                              item.quantity
                            }</p>
                            <button class="remove-item opacity-0 mt-1 text-xs font-medium text-red-600 hover:text-red-500" data-item-id="${index}">Remove</button>
                        </div>
                    `;
            orderItemsContainer.appendChild(itemElement);
          });

          subtotalElement.textContent = `$${orderData.subtotal.toFixed(2)}`;
          shippingElement.textContent = `$${orderData.shipping.toFixed(2)}`;
          taxElement.textContent = `$${orderData.tax.toFixed(2)}`;
          totalElement.textContent = `$${orderData.total.toFixed(2)}`;
        } else {
          orderItemsContainer.innerHTML =
            "<p>Your cart is empty. Please add items to proceed.</p>";
          document.getElementById("complete-order").disabled = true;
        }
      });

      // Payment method selection
      document.querySelectorAll(".payment-method").forEach((method) => {
        method.addEventListener("click", () => {
          document.querySelectorAll(".payment-method").forEach((m) => {
            m.classList.remove("selected");
            m.querySelector(".bg-blue-100").classList.remove("bg-blue-100");
            m.querySelector(".bg-blue-100").classList.add("bg-gray-100");
            m.querySelector(".bg-blue-600").classList.remove("bg-blue-600");
            m.querySelector(".bg-blue-600").classList.add("bg-transparent");
          });

          method.classList.add("selected");
          method.querySelector(".bg-gray-100").classList.remove("bg-gray-100");
          method.querySelector(".bg-gray-100").classList.add("bg-blue-100");
          method
            .querySelector(".bg-transparent")
            .classList.remove("bg-transparent");
          method.querySelector(".bg-transparent").classList.add("bg-blue-600");
        });
      });

      // Format credit card number
      document
        .getElementById("card-number")
        .addEventListener("input", function (e) {
          let value = e.target.value.replace(/\s+/g, "");
          if (value.length > 0) {
            value = value.match(new RegExp(".{1,4}", "g")).join(" ");
          }
          e.target.value = value;
        });

      // Format expiry date
      document
        .getElementById("expiry-date")
        .addEventListener("input", function (e) {
          let value = e.target.value.replace(/\D/g, "");
          if (value.length > 2) {
            value = value.substring(0, 2) + "/" + value.substring(2, 4);
          }
          e.target.value = value;
        });

      // Toggle shipping edit mode
      document.getElementById("edit-shipping").addEventListener("click", () => {
        const inputs = document.querySelectorAll(
          "#first-name, #last-name, #address, #city, #zip, #phone"
        );
        const state = document.getElementById("state");
        if (inputs[0].readOnly) {
          inputs.forEach((input) => input.removeAttribute("readonly"));
          state.removeAttribute("disabled");
          document.getElementById("edit-shipping").textContent = "Save";
        } else {
          inputs.forEach((input) => input.setAttribute("readonly", true));
          state.setAttribute("disabled", true);
          document.getElementById("edit-shipping").textContent = "Edit";
        }
      });

      // Toggle billing address fields
      document
        .getElementById("different-billing")
        .addEventListener("change", () => {
          document.getElementById("billing-fields").classList.toggle("hidden");
        });

      // Remove item from order summary
      document.getElementById("order-items").addEventListener("click", (e) => {
        const removeBtn = e.target.closest(".remove-item");
        if (removeBtn) {
          const index = parseInt(removeBtn.dataset.itemId);
          let orderData = JSON.parse(localStorage.getItem("checkoutData"));
          orderData.items.splice(index, 1); // Remove the item

          // Recalculate totals
          let subtotal = 0;
          orderData.items.forEach((item) => {
            subtotal += item.price * item.quantity;
          });
          let taxRate = 0;
          if (subtotal < 100) taxRate = 0.03;
          else if (subtotal >= 100 && subtotal < 500) taxRate = 0.02;
          const tax = subtotal * taxRate;
          const total = subtotal + tax + orderData.shipping;

          orderData.subtotal = subtotal;
          orderData.tax = tax;
          orderData.total = total;

          // Update localStorage
          localStorage.setItem("checkoutData", JSON.stringify(orderData));

          // Reload the page to reflect changes
          window.location.reload();
        }
      });

      // Handle complete order
      document
        .getElementById("complete-order")
        .addEventListener("click", async () => {
          const shippingData = {
            firstName: document.getElementById("first-name").value,
            lastName: document.getElementById("last-name").value,
            address: document.getElementById("address").value,
            city: document.getElementById("city").value,
            state: document.getElementById("state").value,
            zip: document.getElementById("zip").value,
            phone: document.getElementById("phone").value,
          };

          let billingData = { ...shippingData };
          if (document.getElementById("different-billing").checked) {
            billingData = {
              firstName: document.getElementById("billing-first-name").value,
              lastName: document.getElementById("billing-last-name").value,
              address: document.getElementById("billing-address").value,
              city: document.getElementById("billing-city").value,
              state: document.getElementById("billing-state").value,
              zip: document.getElementById("billing-zip").value,
              phone: document.getElementById("billing-phone").value,
            };
          }

          const paymentMethod = document.querySelector(
            ".payment-method.selected"
          );
          const paymentName = document.getElementById("payment-name").value;
          let paymentData = { nameOnCard: paymentName || "N/A" };
          if (
            paymentMethod &&
            paymentMethod.querySelector("span").textContent === "Credit Card"
          ) {
            paymentData = {
              method: "Credit Card",
              cardNumber: document.getElementById("card-number").value || "N/A",
              nameOnCard:
                document.getElementById("card-name").value ||
                paymentName ||
                "N/A",
              expiryDate: document.getElementById("expiry-date").value || "N/A",
              cvv: document.getElementById("cvv").value || "N/A",
            };
          } else if (
            paymentMethod &&
            paymentMethod.querySelector("span").textContent === "PayPal"
          ) {
            paymentData = {
              method: "PayPal",
              nameOnCard: paymentName || "N/A",
            };
          } else if (
            paymentMethod &&
            paymentMethod.querySelector("span").textContent === "Apple Pay"
          ) {
            paymentData = {
              method: "Apple Pay",
              nameOnCard: paymentName || "N/A",
            };
          }

          const orderData = JSON.parse(localStorage.getItem("checkoutData"));

          try {
            const response = await fetch("http://localhost:3000/api/checkout", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${localStorage.getItem("token")}`,
              },
              body: JSON.stringify({
                shippingData,
                billingData,
                paymentData,
                orderData,
              }),
            });
            const result = await response.json();
            if (response.ok) {
              // Prepare confirmation data
              const confirmationData = {
                orderId: result.orderId,
                orderData: orderData,
                paymentMethod: paymentData.method || "N/A",
              };
              // Store confirmation data in localStorage
              localStorage.setItem(
                "orderConfirmationData",
                JSON.stringify(confirmationData)
              );
              // Clear the cart
              localStorage.removeItem("checkoutData");
              // Show alert and redirect
              alert(`Order placed successfully! Order ID: ${result.orderId}`);
              window.location.href = "order-confirmation.html";
            } else {
              alert(`Error: ${result.error}`);
            }
          } catch (error) {
            alert("Failed to connect to the server");
            console.error(error);
          }
        });
    </script>
  </body>
</html>
